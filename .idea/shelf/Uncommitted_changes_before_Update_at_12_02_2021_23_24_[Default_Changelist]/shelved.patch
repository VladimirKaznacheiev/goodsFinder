Index: app/src/main/java/com/example/goodsfinder/MainActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.goodsfinder;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.annotation.RequiresApi;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport android.accessibilityservice.AccessibilityService;\r\nimport android.annotation.SuppressLint;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.BitmapFactory;\r\nimport android.graphics.Typeface;\r\nimport android.net.ConnectivityManager;\r\nimport android.net.NetworkInfo;\r\nimport android.net.Uri;\r\nimport android.net.UrlQuerySanitizer;\r\nimport android.os.AsyncTask;\r\nimport android.os.Build;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\nimport android.os.StrictMode;\r\nimport android.util.Log;\r\nimport android.util.TypedValue;\r\nimport android.view.GestureDetector;\r\nimport android.view.LayoutInflater;\r\nimport android.view.MotionEvent;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.webkit.WebChromeClient;\r\nimport android.webkit.WebSettings;\r\nimport android.webkit.WebView;\r\nimport android.webkit.WebViewClient;\r\nimport android.widget.Adapter;\r\nimport android.widget.AdapterView;\r\nimport android.widget.ArrayAdapter;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.ListView;\r\nimport android.widget.ProgressBar;\r\nimport android.widget.SearchView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.bumptech.glide.Glide;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.database.DataSnapshot;\r\nimport com.google.firebase.database.DatabaseError;\r\nimport com.google.firebase.database.DatabaseReference;\r\nimport com.google.firebase.database.FirebaseDatabase;\r\nimport com.google.firebase.database.ValueEventListener;\r\n\r\n\r\nimport org.jsoup.Jsoup;\r\nimport org.jsoup.nodes.Document;\r\nimport org.jsoup.nodes.Element;\r\nimport org.jsoup.select.Elements;\r\n\r\n\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.net.HttpURLConnection;\r\nimport java.net.MalformedURLException;\r\nimport java.net.URL;\r\nimport java.util.ArrayList;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\nimport java.util.logging.Logger;\r\n\r\n\r\npublic class MainActivity extends AppCompatActivity {\r\n    private DatabaseReference mDatabase;\r\n    private FirebaseAuth mAuth;\r\n    FirebaseUser user = mAuth.getInstance().getCurrentUser();\r\n\r\n    private static final String TAG = \"artFil\";\r\n\r\n    private final Handler uiHandler = new Handler();\r\n    boolean isFoundMoyo = false;\r\n    boolean isFoundCitrus = false;\r\n    boolean isFoundRozetka = false;\r\n    int currentStoreIndex;\r\n    SearchView mySearchView;\r\n    ListView goodsListView;\r\n    RecyclerView storeListView;\r\n    ProgressBar progressBar;\r\n    int pageCounter = 1;\r\n    int pageCounterMoyo = 1;\r\n    int pageCounterRozerka = 1;\r\n    int goodsCount = 0;\r\n    int goodsCountMoyo = 0;\r\n    int goodsCountRozetka = 0;\r\n    List<Article> articleList = new ArrayList<>();\r\n    List<Article> articleListMoyo = new ArrayList<>();\r\n    List<Article> articleListRozetka = new ArrayList<>();\r\n    ArrayList<String> goodsNamesList = new ArrayList<>();\r\n    ArrayList<String> goodsPricesList = new ArrayList<>();\r\n    ArrayList<String> goodsImagesList = new ArrayList<>();\r\n\r\n    ArrayList<String> goodsImagesListMoyo = new ArrayList<>();\r\n    ArrayList<String> goodsPricesListMoyo = new ArrayList<>();\r\n    ArrayList<String> goodsNamesListMoyo = new ArrayList<>();\r\n\r\n    ArrayList<String> goodsImagesListRozetka = new ArrayList<>();\r\n    ArrayList<String> goodsPricesListRozetka = new ArrayList<>();\r\n    ArrayList<String> goodsNamesListRozetka = new ArrayList<>();\r\n\r\n\r\n\r\n    ArrayList<String> storeTitlesList = new ArrayList<>();\r\n    ArrayList<String> storeImagesList = new ArrayList<>();\r\n    String currentRequestString = \"\";\r\n    TextView errorTextMain;\r\n\r\n    private Document doc = null;\r\n    private Document doc1 = null;\r\n    private Document doc2 = null;\r\n\r\n    private Thread webThread;\r\n    private Runnable runnable;\r\n    MyAdapter adapterCitrus;\r\n    MyAdapter adapterMoyo;\r\n    MyAdapter adapterRozetka;\r\n\r\n    WebView browser;\r\n    WebView browserMoyo;\r\n    WebView browserRozetka;\r\n\r\n    public int getCurrentStoreIndex() {\r\n        return currentStoreIndex;\r\n    }\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n\r\n        mDatabase = FirebaseDatabase.getInstance().getReference();\r\n\r\n        if (FirebaseAuth.getInstance().getCurrentUser() == null){\r\n            Intent intent = new Intent(MainActivity.this, LoginActivity.class);\r\n            startActivity(intent);\r\n        } else {\r\n            if(getSupportActionBar()!=null) getSupportActionBar().setTitle(String.valueOf(FirebaseAuth.getInstance().getCurrentUser().getEmail()));\r\n        }\r\n\r\n\r\n\r\n        isFoundMoyo = false;\r\n        isFoundCitrus = false;\r\n        isFoundRozetka = false;\r\n        browser = new WebView(this);\r\n        browserMoyo = new WebView(this);\r\n        browserRozetka = new WebView(this);\r\n        currentStoreIndex = 0;\r\n        super.onCreate(savedInstanceState);\r\n\r\n        setContentView(R.layout.activity_main);\r\n        initRecyclerView();\r\n\r\n        errorTextMain = findViewById(R.id.errorTextMain);\r\n        errorTextMain.setVisibility(View.INVISIBLE);\r\n        mySearchView = (SearchView) findViewById(R.id.goodsSearchView);\r\n        goodsListView = (ListView) findViewById(R.id.goodsList);\r\n        storeListView = (RecyclerView) findViewById(R.id.storeListView);\r\n        progressBar = findViewById(R.id.progressBar);\r\n        adapterCitrus = new MyAdapter(this, goodsNamesList, goodsPricesList, goodsImagesList,articleList);\r\n        adapterMoyo = new MyAdapter(this, goodsNamesListMoyo, goodsPricesListMoyo, goodsImagesListMoyo,articleListMoyo);\r\n        adapterRozetka = new MyAdapter(this, goodsNamesListRozetka, goodsPricesListRozetka, goodsImagesListRozetka,articleListRozetka);\r\n        goodsListView.setAdapter(adapterMoyo);\r\n\r\n\r\n        getMoyo();\r\n        getRozetka();\r\n\r\n\r\n        storeTitlesList.add(\"Rozetka\");\r\n        storeTitlesList.add(\"Citrus\");\r\n        storeTitlesList.add(\"Allo\");\r\n\r\n\r\n        storeImagesList.add(\"https://mmr.ua/uploaded/materials/a2a89af751.png\");\r\n        storeImagesList.add(\"https://yt3.ggpht.com/ytc/AAUvwnjVEgy0xS7qiFpem68qOwYiIBi4Fls8dZYw9EFm1A=s900-c-k-c0x00ffffff-no-rj\");\r\n        storeImagesList.add(\"data:image/png;base64,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\");\r\n\r\n\r\n        storeListView.addOnItemTouchListener(\r\n                new RecyclerItemClickListener(this, storeListView, new RecyclerItemClickListener.OnItemClickListener() {\r\n                    @Override\r\n                    public void onItemClick(View view, int position) {\r\n\r\n                        if (position == 0) {\r\n                            currentStoreIndex = 0;\r\n                            goodsListView.setAdapter(adapterMoyo);\r\n\r\n                        } else if (position == 1) {\r\n                            currentStoreIndex = 1;\r\n                            goodsListView.setAdapter(adapterCitrus);\r\n\r\n                        }else if (position == 2) {\r\n                            currentStoreIndex = 2;\r\n                            goodsListView.setAdapter(adapterRozetka);\r\n\r\n                        }\r\n                       initRecyclerView();\r\n\r\n                    }\r\n\r\n                    @Override\r\n                    public void onLongItemClick(View view, int position) {\r\n                        // do whatever\r\n                    }\r\n                })\r\n        );\r\n\r\n        findViewById(R.id.btn_logout).setOnClickListener(this::onClick);\r\n        findViewById(R.id.btn_to_chosen).setOnClickListener(this::onClick);\r\n\r\n\r\n        goodsListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {\r\n            @Override\r\n            public void onItemClick(AdapterView<?> adapterView, View view, int i, long l) {\r\n                if (currentStoreIndex == 1) {\r\n                    Element loadElement = doc.getElementsByAttributeValue(\"class\", \"catalog-card-container more-items product-card product-card--mini\").first();\r\n\r\n                    if (loadElement == null ^ i != articleList.size() - 1) {\r\n\r\n                        Uri address = Uri.parse(articleList.get(i).getUrl());\r\n                        Intent openlinkIntent = new Intent(Intent.ACTION_VIEW, address);\r\n                        startActivity(openlinkIntent);\r\n                    } else {\r\n\r\n                        if (isConnected()) {\r\n\r\n                            articleList.remove(articleList.size() - 1);\r\n                            goodsPricesList.remove(goodsPricesList.size() - 1);\r\n                            goodsNamesList.remove(goodsNamesList.size() - 1);\r\n                            goodsImagesList.remove(goodsImagesList.size() - 1);\r\n                            pageCounter++;\r\n                            getCitrus(currentRequestString + \"&page=\" + pageCounter);\r\n\r\n                            progressBar.setVisibility(View.VISIBLE);\r\n                        } else {\r\n\r\n                            errorTextMain.setVisibility(View.VISIBLE);\r\n                            goodsNamesList.clear();\r\n                            goodsImagesList.clear();\r\n                            goodsPricesList.clear();\r\n                            goodsNamesListMoyo.clear();\r\n                            goodsImagesListMoyo.clear();\r\n                            goodsPricesListMoyo.clear();\r\n                            articleList.clear();\r\n                            articleListMoyo.clear();\r\n                            adapterCitrus.notifyDataSetChanged();\r\n                            adapterMoyo.notifyDataSetChanged();\r\n                            currentRequestString = \"\";\r\n                            pageCounter = 1;\r\n                            pageCounterMoyo = 1;\r\n                            goodsCount = 0;\r\n                            goodsCountMoyo = 0;\r\n                        }\r\n                    }\r\n                } else if (currentStoreIndex == 0) {\r\n                    Element loadElement = doc1.getElementsByAttributeValue(\"class\", \"show-more__text\").first();\r\n\r\n                    if (loadElement == null ^ i != articleListMoyo.size() - 1) {\r\n                        Log.d(TAG, articleListMoyo.size() - 1 + \"------\" + i);\r\n                        Uri address = Uri.parse(articleListMoyo.get(i).getUrl());\r\n                        Intent openlinkIntent = new Intent(Intent.ACTION_VIEW, address);\r\n                        startActivity(openlinkIntent);\r\n                    } else {\r\n\r\n                        if (isConnected()) {\r\n                            articleListMoyo.remove(articleListMoyo.size() - 1);\r\n                            goodsPricesListMoyo.remove(goodsPricesListMoyo.size() - 1);\r\n                            goodsNamesListMoyo.remove(goodsNamesListMoyo.size() - 1);\r\n                            goodsImagesListMoyo.remove(goodsImagesListMoyo.size() - 1);\r\n                            pageCounterMoyo++;\r\n\r\n                            getMoyoGoods(\"https://rozetka.com.ua/search/?page=\" + pageCounterMoyo + \"&text=\" + currentRequestString);\r\n                            progressBar.setVisibility(View.VISIBLE);\r\n\r\n\r\n                        } else {\r\n\r\n                            errorTextMain.setVisibility(View.VISIBLE);\r\n                            goodsNamesList.clear();\r\n                            goodsImagesList.clear();\r\n                            goodsPricesList.clear();\r\n                            goodsNamesListMoyo.clear();\r\n                            goodsImagesListMoyo.clear();\r\n                            goodsPricesListMoyo.clear();\r\n                            articleList.clear();\r\n                            articleListMoyo.clear();\r\n                            adapterCitrus.notifyDataSetChanged();\r\n                            adapterMoyo.notifyDataSetChanged();\r\n                            currentRequestString = \"\";\r\n                            pageCounter = 1;\r\n                            pageCounterMoyo = 1;\r\n                            goodsCount = 0;\r\n                            goodsCountMoyo = 0;\r\n                        }\r\n                    }\r\n                }else if (currentStoreIndex == 2) {\r\n                    Element loadElement = doc2.getElementsByAttributeValue(\"class\", \"pagination__next__link\").first();\r\n\r\n                    if (loadElement == null ^ i != articleListRozetka.size() - 1) {\r\n                        Log.d(TAG, articleListRozetka.size() - 1 + \"------\" + i);\r\n                        Uri address = Uri.parse(articleListRozetka.get(i).getUrl());\r\n                        Intent openlinkIntent = new Intent(Intent.ACTION_VIEW, address);\r\n                        startActivity(openlinkIntent);\r\n                    } else {\r\n\r\n                        if (isConnected()) {\r\n                            articleListRozetka.remove(articleListRozetka.size() - 1);\r\n                            goodsPricesListRozetka.remove(goodsPricesListRozetka.size() - 1);\r\n                            goodsNamesListRozetka.remove(goodsNamesListRozetka.size() - 1);\r\n                            goodsImagesListRozetka.remove(goodsImagesListRozetka.size() - 1);\r\n                            pageCounterRozerka++;\r\n\r\n                            getRozetkaGoods(\"https://allo.ua/ru/catalogsearch/result/index/p-\"+pageCounterRozerka+\"/?q=\"+currentRequestString);\r\n                            progressBar.setVisibility(View.VISIBLE);\r\n\r\n\r\n                        } else {\r\n\r\n                            errorTextMain.setVisibility(View.VISIBLE);\r\n                            goodsNamesList.clear();\r\n                            goodsImagesList.clear();\r\n                            goodsPricesList.clear();\r\n                            goodsNamesListMoyo.clear();\r\n                            goodsImagesListMoyo.clear();\r\n                            goodsPricesListMoyo.clear();\r\n                            goodsNamesListRozetka.clear();\r\n                            goodsImagesListRozetka.clear();\r\n                            goodsPricesListRozetka.clear();\r\n                            articleList.clear();\r\n                            articleListMoyo.clear();\r\n                            articleListRozetka.clear();\r\n                            adapterCitrus.notifyDataSetChanged();\r\n                            adapterMoyo.notifyDataSetChanged();\r\n                            adapterRozetka.notifyDataSetChanged();\r\n                            currentRequestString = \"\";\r\n                            pageCounter = 1;\r\n                            pageCounterMoyo = 1;\r\n                            pageCounterRozerka = 1;\r\n                            goodsCount = 0;\r\n                            goodsCountMoyo = 0;\r\n                            goodsCountRozetka = 0;\r\n                        }\r\n                    }\r\n                }\r\n\r\n\r\n            }\r\n\r\n        });\r\n\r\n\r\n        progressBar.setVisibility(View.GONE); // to hide\r\n        mySearchView.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                mySearchView.setIconified(false);\r\n            }\r\n        });\r\n\r\n        mySearchView.setOnQueryTextListener(new SearchView.OnQueryTextListener() {\r\n            @Override\r\n            public boolean onQueryTextSubmit(String s) {\r\n                currentRequestString = \"\";\r\n                pageCounterMoyo = 1;\r\n                pageCounter = 1;\r\n                pageCounterRozerka = 1;\r\n                goodsCountMoyo = 0;\r\n                goodsCount = 0;\r\n                goodsCountRozetka = 0;\r\n                goodsNamesList.clear();\r\n                goodsImagesList.clear();\r\n                goodsPricesList.clear();\r\n                goodsNamesListMoyo.clear();\r\n                goodsImagesListMoyo.clear();\r\n                goodsPricesListMoyo.clear();\r\n                goodsNamesListRozetka.clear();\r\n                goodsImagesListRozetka.clear();\r\n                goodsPricesListRozetka.clear();\r\n                articleList.clear();\r\n                articleListMoyo.clear();\r\n                articleListRozetka.clear();\r\n                if (isConnected()) {\r\n                    errorTextMain.setVisibility(View.INVISIBLE);\r\n                    currentRequestString = s;\r\n                    adapterCitrus.notifyDataSetChanged();\r\n                    adapterMoyo.notifyDataSetChanged();\r\n                    adapterRozetka.notifyDataSetChanged();\r\n\r\n                    progressBar.setVisibility(View.VISIBLE); //to show\r\n\r\n                    getCitrus(s);\r\n                    getMoyoGoods(s);\r\n                    getRozetkaGoods(\"https://allo.ua/ru/catalogsearch/result/?q=\"+s);\r\n\r\n\r\n\r\n                } else {\r\n                    errorTextMain.setVisibility(View.VISIBLE);\r\n                }\r\n\r\n\r\n                return false;\r\n            }\r\n\r\n            @Override\r\n            public boolean onQueryTextChange(String s) {\r\n                return false;\r\n            }\r\n\r\n        });\r\n\r\n        mySearchView.setOnCloseListener(new SearchView.OnCloseListener() {\r\n            @Override\r\n            public boolean onClose() {\r\n                goodsNamesList.clear();\r\n                goodsImagesList.clear();\r\n                goodsPricesList.clear();\r\n                goodsNamesListMoyo.clear();\r\n                goodsImagesListMoyo.clear();\r\n                goodsPricesListMoyo.clear();\r\n                goodsNamesListRozetka.clear();\r\n                goodsImagesListRozetka.clear();\r\n                goodsPricesListRozetka.clear();\r\n                articleList.clear();\r\n                articleListMoyo.clear();\r\n                articleListRozetka.clear();\r\n                adapterCitrus.notifyDataSetChanged();\r\n                adapterMoyo.notifyDataSetChanged();\r\n                adapterRozetka.notifyDataSetChanged();\r\n                currentRequestString = \"\";\r\n                pageCounter = 1;\r\n                pageCounterMoyo = 1;\r\n                pageCounterRozerka = 1;\r\n                goodsCount = 0;\r\n                goodsCountRozetka = 0;\r\n                return false;\r\n            }\r\n        });\r\n\r\n\r\n    }\r\n\r\n    public void onClick(View view) {\r\n        if(view.getId() == R.id.btn_logout) {\r\n            FirebaseAuth.getInstance().signOut();\r\n            if(getSupportActionBar()!=null) getSupportActionBar().setTitle(String.valueOf(FirebaseAuth.getInstance().getCurrentUser()));\r\n\r\n            if (FirebaseAuth.getInstance().getCurrentUser() == null){\r\n                Intent intent = new Intent(MainActivity.this, LoginActivity.class);\r\n                startActivity(intent);\r\n            }\r\n        } else if (view.getId() == R.id.btn_to_chosen){\r\n            Intent intent = new Intent(MainActivity.this, ChosenGoodsActivity.class);\r\n            startActivity(intent);\r\n        }\r\n    }\r\n\r\n    private void initRecyclerView() {\r\n        Log.d(TAG, \"initRecyclerView: init recyclerview\");\r\n\r\n        LinearLayoutManager layoutManager = new LinearLayoutManager(this, LinearLayoutManager.HORIZONTAL, false);\r\n        RecyclerView recyclerView = findViewById(R.id.storeListView);\r\n        recyclerView.setLayoutManager(layoutManager);\r\n        RecyclerViewAdapter adapter = new RecyclerViewAdapter(this, storeTitlesList, storeImagesList);\r\n        recyclerView.setAdapter(adapter);\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    boolean isConnected() {\r\n        boolean connected = false;\r\n        ConnectivityManager connectivityManager = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);\r\n        if (connectivityManager.getNetworkInfo(ConnectivityManager.TYPE_MOBILE).getState() == NetworkInfo.State.CONNECTED ||\r\n                connectivityManager.getNetworkInfo(ConnectivityManager.TYPE_WIFI).getState() == NetworkInfo.State.CONNECTED) {\r\n            //we are connected to a network\r\n            connected = true;\r\n        } else\r\n            connected = false;\r\n\r\n        return connected;\r\n    }\r\n\r\n\r\n\r\n\r\n    void getCitrus(String s){\r\n\r\n        runnable = new Runnable() {\r\n            @Override\r\n            public void run() {\r\n\r\n                try {\r\n                    doc = Jsoup.connect(\"https://www.citrus.ua/search?query=\"+s).get();\r\n                    Elements elements = doc.getElementsByAttributeValue(\"class\", \"short-itm-desc\");\r\n\r\n                    elements.forEach(image-> {\r\n                        Element aElement = image.child(5);\r\n                        Element imgElement = image.child(2);\r\n                        Element priceElement = image.child(7);\r\n                        String url = \"https://www.citrus.ua\"+aElement.attr(\"href\");\r\n                        String title = aElement.child(0).text();\r\n                        String price = \"\";\r\n\r\n                        if (priceElement.child(1).childrenSize()>1){\r\n                            if (priceElement.child(1).child(1).attr(\"class\")==\"price-not-ready\"){\r\n                                price = \"Цена формируется\";\r\n                            } else {\r\n                                price = priceElement.child(1).child(1).child(0).text().replaceAll(\"грн\",\"\");\r\n                            }\r\n                        } else {\r\n                            if (priceElement.child(1).child(0).attr(\"class\")==\"price-not-ready\"){\r\n                                price = \"Цена формируется\";\r\n                            } else {\r\n\r\n                                price = priceElement.child(1).child(0).text().replaceAll(\"грн\",\"\") ;\r\n                            }\r\n                        }\r\n\r\n                        Document doc2 = null;\r\n                        try {\r\n                            doc2 = Jsoup.connect(url).get();\r\n                        } catch (IOException e) {\r\n                            e.printStackTrace();\r\n                        }\r\n                        Elements images = doc2.getElementsByAttributeValue(\"class\", \"gallery\").select(\"img\");\r\n                        String img = images.attr(\"src\");\r\n\r\n\r\n\r\n\r\n                        articleList.add(new Article(url, title, price+ \" грн\",  img));\r\n                    });\r\n\r\n                    for (int i = goodsCount; i < articleList.size(); i++) {\r\n                        goodsNamesList.add(articleList.get(i).getName());\r\n                        goodsPricesList.add(articleList.get(i).getPrice() );\r\n\r\n                        goodsImagesList.add(articleList.get(i).getImg());\r\n\r\n\r\n\r\n                    }\r\n                    goodsCount = articleList.size();\r\n                    Element loadElement = doc.getElementsByAttributeValue(\"class\", \"catalog-card-container more-items product-card product-card--mini\").first();\r\n\r\n                    if (loadElement != null) {\r\n                        goodsNamesList.add(\"Загрузить ещё\");\r\n                        goodsPricesList.add(\"\");\r\n\r\n                        goodsImagesList.add(\"https://image.flaticon.com/icons/png/512/16/16770.png\");\r\n                        articleList.add(new Article(\" \", \"Загрузить ещё\", \"\", \"https://image.flaticon.com/icons/png/512/16/16770.png\"));\r\n\r\n                    }\r\n\r\n                    runOnUiThread(new Runnable() {\r\n\r\n                        @Override\r\n                        public void run() {\r\n                            progressBar.setVisibility(View.GONE); // to hide\r\n                            adapterCitrus.notifyDataSetChanged();\r\n                            goodsListView.setEnabled(true);\r\n                        }\r\n                    });\r\n\r\n\r\n                } catch (IOException e) {\r\n                    e.printStackTrace();\r\n                    Log.d(TAG,\"CITRUS ERROR\");\r\n                }\r\n\r\n\r\n\r\n            }\r\n        };\r\n\r\n\r\n        webThread = new Thread(runnable);\r\n        webThread.start();\r\n\r\n    }\r\n\r\n\r\n\r\n    void getMoyoGoods(String search) {\r\n        goodsListView.setEnabled(false);\r\n        //isFoundMoyo = false;\r\n        uiHandler.post(new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                String search1 = search.replace(\" \", \"+\");\r\n                if (search.contains(\"page=\")){\r\n                    browserMoyo.loadUrl(search1);\r\n                }else{\r\n                    browserMoyo.loadUrl(\"https://rozetka.com.ua/search/?text=\" + search1);\r\n                }\r\n\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    @SuppressLint(\"SetJavaScriptEnabled\")\r\n    void getMoyo() {\r\n        try {\r\n//            isFoundMoyo = false;\r\n\r\n            browserMoyo.setVisibility(View.INVISIBLE);\r\n            browserMoyo.setLayerType(View.LAYER_TYPE_NONE, null);\r\n            browserMoyo.getSettings().setJavaScriptEnabled(true);\r\n            browserMoyo.getSettings().setBlockNetworkImage(false);\r\n            browserMoyo.getSettings().setDomStorageEnabled(true);\r\n            browserMoyo.getSettings().setLoadsImagesAutomatically(true);\r\n            browserMoyo.getSettings().setBlockNetworkLoads(false);\r\n            browserMoyo.getSettings().setJavaScriptCanOpenWindowsAutomatically(true);\r\n            browserMoyo.getSettings().setDefaultTextEncodingName(\"utf-8\");\r\n\r\n            browserMoyo.addJavascriptInterface(new JSHtmlInterfaceMoyo(), \"JSBridge\");\r\n\r\n            browserMoyo.setWebViewClient(\r\n                    new WebViewClient() {\r\n\r\n                        @Override\r\n                        public void onPageStarted(WebView view, String url, Bitmap favicon) {\r\n                            super.onPageStarted(view, url, favicon);\r\n                        }\r\n\r\n                        @Override\r\n                        public void onPageFinished(WebView view, String url) {\r\n                            browserMoyo.loadUrl(\"javascript:window.JSBridge.showHTML('<html>'+document.getElementsByTagName('html')[0].innerHTML+'</html>');\");\r\n                        }\r\n                    }\r\n            );\r\n\r\n\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n            Log.d(TAG, \"Moyo Error\");\r\n        }\r\n\r\n\r\n    }\r\n\r\n    private class JSHtmlInterfaceMoyo{\r\n        @android.webkit.JavascriptInterface\r\n        public void showHTML(String html) {\r\n            final String htmlContent = html;\r\n\r\n            uiHandler.post(\r\n                    new Runnable() {\r\n                        @Override\r\n                        public void run() {\r\n//                            if (!isFoundMoyo) {\r\n\r\n                                doc1 = Jsoup.parse(htmlContent);\r\n                                Elements elements = doc1.getElementsByAttributeValue(\"class\", \"goods-tile__inner\");\r\n\r\n                                boolean isConsist = false;\r\n                                for (Element element : elements) {\r\n                                    String url = element.getElementsByAttributeValue(\"class\", \"goods-tile__heading\").first().attr(\"href\") ;\r\n                                    String price = element.getElementsByAttributeValue(\"class\", \"goods-tile__price-value\").first().text() ;\r\n                                    String title = element.getElementsByAttributeValue(\"class\", \"goods-tile__heading\").first().text();\r\n                                    String imgUrl = element.getElementsByAttributeValue(\"class\", \"goods-tile__picture\").first().child(1).attr(\"src\");\r\n\r\n\r\n                                    articleListMoyo.add(new Article(url, title, price, imgUrl));\r\n\r\n\r\n                                }\r\n\r\n                                runOnUiThread(new Runnable() {\r\n\r\n                                    @Override\r\n                                    public void run() {\r\n\r\n                                        for (int i = goodsCountMoyo; i < articleListMoyo.size(); i++) {\r\n                                            goodsNamesListMoyo.add(articleListMoyo.get(i).getName());\r\n                                            goodsPricesListMoyo.add(articleListMoyo.get(i).getPrice() + \" грн\");\r\n\r\n                                            goodsImagesListMoyo.add(articleListMoyo.get(i).getImg());\r\n\r\n\r\n                                        }\r\n                                        goodsCountMoyo = articleListMoyo.size();\r\n                                        Element loadElement = doc1.getElementsByAttributeValue(\"class\", \"show-more__text\").first();\r\n\r\n                                        if (loadElement != null) {\r\n                                            goodsNamesListMoyo.add(\"Загрузить ещё\");\r\n                                            goodsPricesListMoyo.add(\"\");\r\n\r\n                                            goodsImagesListMoyo.add(\"https://image.flaticon.com/icons/png/512/16/16770.png\");\r\n                                            articleListMoyo.add(new Article(\" \", \"Загрузить ещё\", \"\", \"https://image.flaticon.com/icons/png/512/16/16770.png\"));\r\n\r\n                                        }\r\n                                        progressBar.setVisibility(View.GONE); // to hide\r\n\r\n\r\n                                    }\r\n                                });\r\n\r\n                                Log.d(TAG, articleListMoyo.size() + \"  \" + goodsImagesListMoyo.size());\r\n\r\n                                isFoundMoyo = true;\r\n                                adapterMoyo.notifyDataSetChanged();\r\n                                goodsListView.setEnabled(true);\r\n//                            }\r\n\r\n                            //Log.d(\"TEST\", doc.html());\r\n                        }\r\n                    }\r\n            );\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    void getRozetkaGoods(String search) {\r\n        goodsListView.setEnabled(false);\r\n        isFoundRozetka = false;\r\n        uiHandler.post(new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                String search1 = search.replace(\" \", \"%20\");\r\n                browserRozetka.loadUrl(search1);\r\n\r\n                //if(getSupportActionBar()!=null) getSupportActionBar().setTitle(browserRozetka.getUrl());\r\n                Log.d(TAG,\"Step 2\");\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    void getRozetka() {\r\n        try {\r\n\r\n            isFoundRozetka = false;\r\n            Log.d(TAG,\"Step 1\");\r\n            browserRozetka.setWebChromeClient(new WebChromeClient());\r\n            browserRozetka.setVisibility(View.INVISIBLE);\r\n            browserRozetka.setLayerType(View.LAYER_TYPE_NONE,null);\r\n            browserRozetka.setWebChromeClient(new WebChromeClient());\r\n            browserRozetka.getSettings().setJavaScriptEnabled(true);\r\n            browserRozetka.getSettings().setJavaScriptCanOpenWindowsAutomatically(true);\r\n            browserRozetka.getSettings().setDomStorageEnabled(true);\r\n            browserRozetka.getSettings().setBlockNetworkLoads(false);\r\n            browserRozetka.getSettings().setBlockNetworkImage(false);\r\n            browserRozetka.getSettings().setLoadWithOverviewMode(true);\r\n            browserRozetka.getSettings().setUseWideViewPort(true);\r\n            browserRozetka.getSettings().setDefaultTextEncodingName(\"utf-8\");\r\n\r\n            browserRozetka.addJavascriptInterface(new JSHtmlInterfaceRozetka(), \"JSBridge\");\r\n\r\n            browserRozetka.setWebViewClient(\r\n                    new WebViewClient() {\r\n\r\n                        @Override\r\n                        public void onPageStarted(WebView view, String url, Bitmap favicon) {\r\n\r\n                            super.onPageStarted(view, url, favicon);\r\n                        }\r\n\r\n                        @Override\r\n                        public void onPageFinished(WebView view, String url) {\r\n                            browserRozetka.loadUrl(\"javascript:window.JSBridge.showHTML('<html>'+document.getElementsByTagName('html')[0].innerHTML+'</html>');\");\r\n\r\n                        }\r\n                    }\r\n            );\r\n\r\n\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n            Log.d(TAG, \"Rozetka Error\");\r\n        }\r\n\r\n\r\n    }\r\n\r\n    private class JSHtmlInterfaceRozetka{\r\n        @android.webkit.JavascriptInterface\r\n        public void showHTML(String html) {\r\n            final String htmlContent = html;\r\n\r\n            uiHandler.post(\r\n                    new Runnable() {\r\n                        @Override\r\n                        public void run() {\r\n\r\n                            if (!isFoundRozetka) {\r\n                                Log.d(TAG, \"Step 3\");\r\n                                Log.d(TAG, htmlContent);\r\n                                doc2 = Jsoup.parse(htmlContent);\r\n                                Elements elements = doc2.getElementsByAttributeValue(\"class\", \"product-card\");\r\n                                for (Element element : elements) {\r\n                                    String title = element.getElementsByAttributeValue(\"class\", \"product-card__title\").first().text();\r\n                                    String url = element.getElementsByAttributeValue(\"class\", \"product-card__title\").first().attr(\"href\");\r\n                                    String price = element.getElementsByAttributeValue(\"class\", \"sum\").last().text();\r\n                                    // String imgUrl = String.valueOf(element.getElementsByAttributeValue(\"class\", \"goods-tile__picture\").first().childrenSize());\r\n                                    String imgUrl = element.getElementsByAttributeValue(\"class\", \"gallery__img-wrapper\").first().select(\"img\").attr(\"data-src\");\r\n\r\n                                    articleListRozetka.add(new Article(url, title, price, imgUrl));\r\n\r\n\r\n                                }\r\n\r\n                                runOnUiThread(new Runnable() {\r\n\r\n                                    @Override\r\n                                    public void run() {\r\n\r\n                                        for (int i = goodsCountRozetka; i < articleListRozetka.size(); i++) {\r\n                                            goodsNamesListRozetka.add(articleListRozetka.get(i).getName());\r\n                                            goodsPricesListRozetka.add(articleListRozetka.get(i).getPrice() + \" грн\");\r\n\r\n                                            goodsImagesListRozetka.add(articleListRozetka.get(i).getImg());\r\n                                            Log.d(TAG, articleListRozetka.get(i).toString());\r\n\r\n                                        }\r\n                                        goodsCountRozetka = articleListRozetka.size();\r\n                                        Element loadElement = doc2.getElementsByAttributeValue(\"class\", \"pagination__next__link\").first();\r\n\r\n                                        if (loadElement != null) {\r\n                                            goodsNamesListRozetka.add(\"Загрузить ещё\");\r\n                                            goodsPricesListRozetka.add(\"\");\r\n\r\n                                            goodsImagesListRozetka.add(\"https://image.flaticon.com/icons/png/512/16/16770.png\");\r\n                                            articleListRozetka.add(new Article(\" \", \"Загрузить ещё\", \"\", \"https://image.flaticon.com/icons/png/512/16/16770.png\"));\r\n\r\n                                        }\r\n                                        progressBar.setVisibility(View.GONE); // to hide\r\n\r\n\r\n                                    }\r\n                                });\r\n\r\n\r\n                                isFoundRozetka = true;\r\n                                adapterRozetka.notifyDataSetChanged();\r\n                                goodsListView.setEnabled(true);\r\n                            }\r\n                        }\r\n                    }\r\n            );\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    class MyAdapter extends ArrayAdapter<String> {\r\n\r\n        Context context;\r\n        List<String> rTitle = new ArrayList();\r\n        List<String> rDescription = new ArrayList();\r\n        List<String> rImgs = new ArrayList();\r\n        List<Article> arrLIst = new ArrayList<>();\r\n\r\n\r\n        MyAdapter(Context c, List<String> title, List<String> description, List<String> imgs, List arrList) {\r\n            super(c, R.layout.goods_view, R.id.goodsTitleMain, title);\r\n            this.context = c;\r\n            this.rTitle = title;\r\n            this.rDescription = description;\r\n            this.rImgs = imgs;\r\n            this.arrLIst = arrList;\r\n\r\n        }\r\n\r\n\r\n        @NonNull\r\n        @Override\r\n        public View getView(int position, @Nullable View convertView, @NonNull ViewGroup parent) {\r\n            LayoutInflater layoutInflater = (LayoutInflater) getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);\r\n            View goodsView = layoutInflater.inflate(R.layout.goods_view, parent, false);\r\n            ImageView images = goodsView.findViewById(R.id.goodsImageMain);\r\n            ImageView imageFavourite = goodsView.findViewById(R.id.goodsFavourite);\r\n            TextView myTitle = goodsView.findViewById(R.id.goodsTitleMain);\r\n            TextView myDescription = goodsView.findViewById(R.id.goodsPriceMain);\r\n\r\n            // now set our resources on views\r\n\r\n\r\n            Glide.with(context).load(rImgs.get(position)).into(images);\r\n            myTitle.setText(rTitle.get(position));\r\n\r\n\r\n            mDatabase.child(\"Users\").child(user.getUid()).addValueEventListener(new ValueEventListener() {\r\n                public boolean inChosen = false;\r\n                @Override\r\n                public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n\r\n                    for (DataSnapshot childDataSnapshot : snapshot.getChildren()) {\r\n                        String str = arrLIst.get(position).getUrl();\r\n                        String[] goodsInfo = String.valueOf(childDataSnapshot.getValue()).split(\"split\", 2);\r\n                        if (goodsInfo[0].equals(str)){\r\n                            inChosen = true;\r\n                        }\r\n\r\n                        if(inChosen){\r\n                            imageFavourite.setImageResource(R.drawable.ic_baseline_star_24);\r\n                        }else{\r\n                            imageFavourite.setImageResource(R.drawable.ic_baseline_star_border_24);\r\n                        }\r\n                    }\r\n\r\n                }\r\n\r\n                @Override\r\n                public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n                }\r\n            });\r\n\r\n\r\n\r\n            if (rTitle.get(position) == \"Загрузить ещё\") {\r\n                imageFavourite.setVisibility(View.GONE);\r\n                myTitle.setTypeface(null, Typeface.BOLD_ITALIC);\r\n                myTitle.setTextSize(TypedValue.COMPLEX_UNIT_SP, 25);\r\n            }\r\n            myDescription.setText(rDescription.get(position));\r\n\r\n\r\n\r\n\r\n\r\n            imageFavourite.setOnClickListener(new View.OnClickListener() {\r\n                @Override\r\n                public void onClick(View view) {\r\n                    Log.d(TAG,arrLIst.get(position).getUrl());\r\n                    Log.d(TAG,arrLIst.get(position).getImg());\r\n                    Log.d(TAG,arrLIst.get(position).getName());\r\n                    Log.d(TAG,arrLIst.get(position).getPrice());\r\n\r\n\r\n\r\n\r\n                    mDatabase.child(\"Users\").child(user.getUid()).addValueEventListener(new ValueEventListener() {\r\n                        public boolean inChosen;\r\n                        @Override\r\n                        public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                            Map<String, Object> td = (HashMap<String,Object>) snapshot.getValue();\r\n\r\n                            for (DataSnapshot childDataSnapshot : snapshot.getChildren()) {\r\n\r\n                                DatabaseReference objRef = FirebaseDatabase.getInstance().getReference().child(\"Users\").child(user.getUid()).child( childDataSnapshot.getKey());\r\n                                Map<String,Object> taskMap = new HashMap<String,Object>();\r\n                                objRef.updateChildren(taskMap);\r\n\r\n\r\n                                String str = arrLIst.get(position).getUrl();\r\n                                String[] goodsInfo = String.valueOf(childDataSnapshot.getValue()).split(\"split\", 2);\r\n                                if (goodsInfo[0].equals(str)){\r\n                                    inChosen = true;\r\n\r\n                                       /* imageFavourite.setImageResource(R.drawable.ic_baseline_star_24);*/\r\n                                        Toast.makeText(MainActivity.this, \"Товар был ранее добален в избранные\", Toast.LENGTH_SHORT).show();\r\n                                        mDatabase.child(\"Users\").child(user.getUid()).child(childDataSnapshot.getKey()).setValue(null);\r\n                                    mDatabase.child(\"Users\").child(user.getUid()).removeEventListener(this);\r\n                                        break;\r\n\r\n                                }else{\r\n                                    inChosen = false;\r\n                                }\r\n\r\n\r\n                            }\r\n\r\n                            if (!inChosen){\r\n                              /*  imageFavourite.setImageResource(R.drawable.ic_baseline_star_border_24);*/\r\n                                mDatabase.child(\"Users\").child(user.getUid()).push().setValue(arrLIst.get(position).getUrl()+\"split\"+arrLIst.get(position).getImg()+\"split\"+arrLIst.get(position).getName()+\"split\"+arrLIst.get(position).getPrice()+\"split\"+arrLIst.get(position).getPrice());\r\n                                mDatabase.child(\"Users\").child(user.getUid()).removeEventListener(this);\r\n                                Toast.makeText(MainActivity.this, \"Товара нет в избранных, добавляю\", Toast.LENGTH_SHORT).show();\r\n                                return;\r\n                            }\r\n\r\n\r\n\r\n\r\n                        }\r\n\r\n                        @Override\r\n                        public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n                        }\r\n                    });\r\n\r\n\r\n                }\r\n            });\r\n\r\n            return goodsView;\r\n        }\r\n    }\r\n\r\n\r\n    class Article {\r\n        private String url;\r\n        private String name;\r\n        private String img;\r\n        private String price;\r\n\r\n\r\n        public Article(String url, String name, String price, String img) {\r\n            this.url = url;\r\n            this.name = name;\r\n            this.price = price;\r\n            this.img = img;\r\n        }\r\n\r\n\r\n        public String getUrl() {\r\n            return url;\r\n        }\r\n\r\n        public void setUrl(String url) {\r\n            this.url = url;\r\n        }\r\n\r\n        public String getName() {\r\n            return name;\r\n        }\r\n\r\n        public void setName(String name) {\r\n            this.name = name;\r\n        }\r\n\r\n        public String getPrice() {\r\n            return price;\r\n        }\r\n\r\n        public void setPrice(String name) {\r\n            this.price = price;\r\n        }\r\n\r\n        public String getImg() {\r\n            return img;\r\n        }\r\n\r\n        public void setImg(String img) {\r\n            this.img = img;\r\n        }\r\n\r\n        @Override\r\n        public String toString() {\r\n            return \"Article{\" +\r\n                    \"url='\" + url + '\\'' +\r\n                    \", name='\" + name + '\\'' +\r\n                    \", img='\" + img + '\\'' +\r\n                    \", price='\" + price + '\\'' +\r\n                    '}';\r\n        }\r\n    }\r\n\r\n    static class RecyclerItemClickListener implements RecyclerView.OnItemTouchListener {\r\n        private OnItemClickListener mListener;\r\n\r\n        public interface OnItemClickListener {\r\n            public void onItemClick(View view, int position);\r\n\r\n            public void onLongItemClick(View view, int position);\r\n        }\r\n\r\n        GestureDetector mGestureDetector;\r\n\r\n        public RecyclerItemClickListener(Context context, final RecyclerView recyclerView, OnItemClickListener listener) {\r\n            mListener = listener;\r\n            mGestureDetector = new GestureDetector(context, new GestureDetector.SimpleOnGestureListener() {\r\n                @Override\r\n                public boolean onSingleTapUp(MotionEvent e) {\r\n                    return true;\r\n                }\r\n\r\n                @Override\r\n                public void onLongPress(MotionEvent e) {\r\n                    View child = recyclerView.findChildViewUnder(e.getX(), e.getY());\r\n                    if (child != null && mListener != null) {\r\n                        mListener.onLongItemClick(child, recyclerView.getChildAdapterPosition(child));\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        @Override\r\n        public boolean onInterceptTouchEvent(RecyclerView view, MotionEvent e) {\r\n            View childView = view.findChildViewUnder(e.getX(), e.getY());\r\n            if (childView != null && mListener != null && mGestureDetector.onTouchEvent(e)) {\r\n                mListener.onItemClick(childView, view.getChildAdapterPosition(childView));\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n\r\n        @Override\r\n        public void onTouchEvent(RecyclerView view, MotionEvent motionEvent) {\r\n        }\r\n\r\n        @Override\r\n        public void onRequestDisallowInterceptTouchEvent(boolean disallowIntercept) {\r\n        }\r\n    }\r\n\r\n\r\n    class RecyclerViewAdapter extends RecyclerView.Adapter<RecyclerViewAdapter.ViewHolder> {\r\n\r\n        private static final String TAG = \"RecyclerViewAdapter\";\r\n\r\n        //vars\r\n        private ArrayList<String> mNames = new ArrayList<>();\r\n        private ArrayList<String> mImageUrls = new ArrayList<>();\r\n        private Context mContext;\r\n\r\n        public RecyclerViewAdapter(Context context, ArrayList<String> names, ArrayList<String> imageUrls) {\r\n            mNames = names;\r\n            mImageUrls = imageUrls;\r\n            mContext = context;\r\n        }\r\n\r\n        @Override\r\n        public ViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {\r\n            View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.store_view, parent, false);\r\n            return new ViewHolder(view);\r\n        }\r\n\r\n        @Override\r\n        public void onBindViewHolder(ViewHolder holder, final int position) {\r\n            Log.d(TAG, \"onBindViewHolder: called.\");\r\n\r\n\r\n            Glide.with(mContext)\r\n                    .asBitmap()\r\n                    .load(mImageUrls.get(position))\r\n                    .into(holder.image);\r\n\r\n            holder.name.setText(mNames.get(position));\r\n\r\n\r\n            if(position == currentStoreIndex){\r\n                holder.name.setTextSize(TypedValue.COMPLEX_UNIT_SP, 18);\r\n\r\n\r\n                holder.image.getLayoutParams().height = (int) getResources().getDimension(R.dimen.imageview_height);\r\n                holder.image.getLayoutParams().width = (int) getResources().getDimension(R.dimen.imageview_width);\r\n            }\r\n            holder.image.setOnClickListener(new View.OnClickListener() {\r\n                @Override\r\n                public void onClick(View view) {\r\n\r\n                }\r\n            });\r\n        }\r\n\r\n\r\n\r\n        @Override\r\n        public int getItemCount() {\r\n            return mImageUrls.size();\r\n        }\r\n\r\n\r\n        public class ViewHolder extends RecyclerView.ViewHolder {\r\n\r\n            ImageView image;\r\n            TextView name;\r\n\r\n            public ViewHolder(View itemView) {\r\n                super(itemView);\r\n                image = itemView.findViewById(R.id.storeImageMain);\r\n                name = itemView.findViewById(R.id.storeTitleMain);\r\n            }\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/goodsfinder/MainActivity.java	(revision 8c6d4c9292e23216e5c03b155d7b05b5d0ad8d0b)
+++ app/src/main/java/com/example/goodsfinder/MainActivity.java	(date 1612885170647)
@@ -972,6 +972,7 @@
 
                                        /* imageFavourite.setImageResource(R.drawable.ic_baseline_star_24);*/
                                         Toast.makeText(MainActivity.this, "Товар был ранее добален в избранные", Toast.LENGTH_SHORT).show();
+                                        notifyDataSetChanged();
                                         mDatabase.child("Users").child(user.getUid()).child(childDataSnapshot.getKey()).setValue(null);
                                     mDatabase.child("Users").child(user.getUid()).removeEventListener(this);
                                         break;
@@ -988,6 +989,7 @@
                                 mDatabase.child("Users").child(user.getUid()).push().setValue(arrLIst.get(position).getUrl()+"split"+arrLIst.get(position).getImg()+"split"+arrLIst.get(position).getName()+"split"+arrLIst.get(position).getPrice()+"split"+arrLIst.get(position).getPrice());
                                 mDatabase.child("Users").child(user.getUid()).removeEventListener(this);
                                 Toast.makeText(MainActivity.this, "Товара нет в избранных, добавляю", Toast.LENGTH_SHORT).show();
+                                notifyDataSetChanged();
                                 return;
                             }
 
Index: app/src/main/res/layout/login_activity.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<RelativeLayout\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/activity_authentication\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:background=\"@color/blue_800\"\r\n    tools:context=\".MainActivity\">\r\n\r\n\r\n    <EditText android:layout_width=\"250dp\"\r\n        android:layout_height=\"50dp\"\r\n        android:id=\"@+id/et_email\"\r\n        android:layout_centerHorizontal=\"true\"\r\n        android:layout_marginTop=\"145dp\"\r\n        android:hint=\"Email\"\r\n        android:textColorHint=\"@color/grey_50\"\r\n        android:textSize=\"30dp\"/>\r\n    <EditText android:layout_width=\"250dp\"\r\n        android:layout_height=\"50dp\"\r\n        android:layout_centerHorizontal=\"true\"\r\n        android:layout_below=\"@+id/et_email\"\r\n        android:hint=\"Password\"\r\n        android:textColorHint=\"@color/grey_50\"\r\n        android:textSize=\"30dp\"\r\n        android:id=\"@+id/et_password\"\r\n        />\r\n\r\n    <LinearLayout android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\"\r\n        android:layout_below=\"@+id/et_password\"\r\n        android:layout_marginTop=\"20dp\"\r\n        >\r\n        <Button android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:text=\"Авторизация\"\r\n            android:layout_weight=\"1\"\r\n            android:id=\"@+id/btn_sign_in\"/>\r\n        <Button android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:layout_weight=\"1\"\r\n            android:text=\"Регистрация\"\r\n            android:id=\"@+id/btn_registration\"/>\r\n\r\n    </LinearLayout>\r\n</RelativeLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/login_activity.xml	(revision 8c6d4c9292e23216e5c03b155d7b05b5d0ad8d0b)
+++ app/src/main/res/layout/login_activity.xml	(date 1612894188181)
@@ -1,47 +1,80 @@
 <?xml version="1.0" encoding="utf-8"?>
 <RelativeLayout
     xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
     xmlns:tools="http://schemas.android.com/tools"
     android:id="@+id/activity_authentication"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
-    android:background="@color/blue_800"
+    android:background="#263238"
     tools:context=".MainActivity">
 
 
-    <EditText android:layout_width="250dp"
-        android:layout_height="50dp"
+    <ImageView
+        android:id="@+id/imageView2"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        app:srcCompat="@drawable/ic_rectangle"
+
+        />
+
+    <EditText android:layout_width="300dp"
+        android:layout_height="40dp"
         android:id="@+id/et_email"
         android:layout_centerHorizontal="true"
-        android:layout_marginTop="145dp"
+        android:layout_marginTop="300dp"
         android:hint="Email"
         android:textColorHint="@color/grey_50"
-        android:textSize="30dp"/>
-    <EditText android:layout_width="250dp"
-        android:layout_height="50dp"
+        android:textSize="20dp"
+        android:background="@drawable/ic_rectangle_2"
+        android:textAlignment="center"
+        />
+
+    <EditText
+        android:id="@+id/et_password"
+        android:layout_width="300dp"
+        android:layout_height="40dp"
+        android:layout_below="@+id/et_email"
         android:layout_centerHorizontal="true"
-        android:layout_below="@+id/et_email"
+        android:layout_marginTop="30dp"
+        android:background="@drawable/ic_rectangle_2"
         android:hint="Password"
+        android:textAlignment="center"
         android:textColorHint="@color/grey_50"
-        android:textSize="30dp"
-        android:id="@+id/et_password"
-        />
+        android:textSize="20dp" />
 
-    <LinearLayout android:layout_width="match_parent"
+    <LinearLayout
+        android:layout_width="match_parent"
         android:layout_height="wrap_content"
-        android:layout_below="@+id/et_password"
-        android:layout_marginTop="20dp"
-        >
-        <Button android:layout_width="match_parent"
-            android:layout_height="match_parent"
-            android:text="Авторизация"
-            android:layout_weight="1"
-            android:id="@+id/btn_sign_in"/>
-        <Button android:layout_width="match_parent"
-            android:layout_height="match_parent"
-            android:layout_weight="1"
-            android:text="Регистрация"
-            android:id="@+id/btn_registration"/>
+        android:layout_alignParentTop="true"
+        android:layout_marginTop="550dp">
+
+        <Button
+            android:id="@+id/btn_sign_in"
+            android:layout_width="300dp"
+            android:layout_height="50dp"
+            android:layout_marginLeft="40dp"
+            android:layout_marginRight="20dp"
+            android:layout_weight="0.5"
+            android:textAlignment="center"
+            android:text="Sign In"
+            android:textSize="20sp"
+            android:textColor="@color/white"
+            android:background="@drawable/ic_rectangle_4"/>
+
+        <Button
+            android:id="@+id/btn_registration"
+            android:layout_width="300dp"
+            android:layout_height="50dp"
+            android:layout_marginLeft="40dp"
+            android:layout_marginRight="40dp"
+            android:layout_weight="0.5"
+            android:textAlignment="center"
+            android:text="Sing Up"
+            android:textSize="20sp"
+            android:textColor="@color/white"
+            android:background="@drawable/ic_rectangle_4"/>
 
     </LinearLayout>
+
 </RelativeLayout>
\ No newline at end of file
Index: app/src/main/res/drawable/ic_baseline_delete_24.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><vector xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    android:width=\"24dp\"\r\n    android:height=\"24dp\"\r\n    android:viewportWidth=\"24\"\r\n    android:viewportHeight=\"24\"\r\n    android:tint=\"?attr/colorControlNormal\">\r\n  <path\r\n      android:fillColor=\"@android:color/black\"\r\n      android:pathData=\"M6,19c0,1.1 0.9,2 2,2h8c1.1,0 2,-0.9 2,-2V7H6v12zM19,4h-3.5l-1,-1h-5l-1,1H5v2h14V4z\"/>\r\n</vector>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/drawable/ic_baseline_delete_24.xml	(revision 8c6d4c9292e23216e5c03b155d7b05b5d0ad8d0b)
+++ app/src/main/res/drawable/ic_baseline_delete_24.xml	(date 1612467478195)
@@ -5,6 +5,6 @@
     android:viewportHeight="24"
     android:tint="?attr/colorControlNormal">
   <path
-      android:fillColor="@android:color/black"
+      android:fillColor="#AE8A8A8A"
       android:pathData="M6,19c0,1.1 0.9,2 2,2h8c1.1,0 2,-0.9 2,-2V7H6v12zM19,4h-3.5l-1,-1h-5l-1,1H5v2h14V4z"/>
 </vector>
